<project default="jar:jar"
  xmlns:j="jelly:core"
  xmlns:ant="jelly:ant"
  xmlns:maven="jelly:maven">

  <!--
   Build the .war file.
  -->
  <postGoal name="dist">
      <attainGoal name="war"/>
  </postGoal>

  <preGoal name="war:war">

        <!-- Include struts-el .jar file in WEB-INF/lib -->
        <ant:copy todir="${maven.war.webapp.dir}/WEB-INF/lib/" overwrite="false"
            file="${basedir}/target/struts-el-1.3.0.jar" />

        <!-- Include properties under WEB-INF/classes -->
        <ant:copy todir="${maven.war.webapp.dir}/WEB-INF/classes/" overwrite="false">
            <ant:fileset dir="${basedir}/src/exercise-taglib"
                includes="**/*.properties">
           </ant:fileset>
         </ant:copy>

        <!-- Include source code in example webapp -->
        <ant:copy todir="${maven.war.webapp.dir}/WEB-INF/src/" overwrite="false">
          <ant:fileset dir="${basedir}/src/exercise-taglib"
                       excludes="**/.svn/**">
           </ant:fileset>
        </ant:copy>
  </preGoal>

  <!-- Compile the source for the webapp in addition to the taglib
  See: http://maven.apache.org/faq.html#multiple-source-directories -->
  <preGoal name="java:compile">
    <ant:path
       id="exercise.src.dir"
       location="${basedir}/src/exercise-taglib"/>
    <maven:addPath
       id="maven.compile.src.set"
       refid="exercise.src.dir"/>
  </preGoal>

</project>
