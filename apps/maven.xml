<?xml version="1.0"?>

<project    default="dist"
            xmlns:j="jelly:core"
            xmlns:ant="jelly:ant"
            xmlns:maven="jelly:maven">
            
	
    <goal name="dist">

        <maven:reactor  basedir="${basedir}"
                        includes="mailreader-dao/project.xml"
                        goals="jar:install"
                        banner="Building mailreader DAO jar"
                        ignoreFailures="false"/>
                        
        <maven:reactor  basedir="${basedir}"
                        includes="*/project.xml"
                        excludes="mailreader-dao/project.xml,../build/project.xml"
                        goals="java:compile,war:webapp,war:war"
                        banner="Building Struts apps"
                        ignoreFailures="false"/>
                        
    </goal>

    <postGoal name="clean">
        <maven:reactor  basedir="${basedir}"
                        includes="*/project.xml"
                        goals="clean"
                        banner="Cleaning Struts apps"
                        ignoreFailures="false"/>
    </postGoal>
    
    <preGoal name="test:test">
    	<echo>maven.test.dest    = ${maven.test.dest}</echo>
    </preGoal>

	<goal name="copy-distribution">
	   <!-- override -->
	</goal>

    <goal name="copy-webapp-src">
    <ant:copy todir="${maven.war.webapp.dir}/WEB-INF/src/java" overwrite="false">
      <ant:fileset dir="${basedir}/src/java"
           excludes="**/.svn/**">
       </ant:fileset>
    </ant:copy>

  </goal>

</project>
